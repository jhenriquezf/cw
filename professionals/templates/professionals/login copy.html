{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link as="style" href="https://fonts.googleapis.com/css2?display=swap&family=Manrope:wght@400;500;700;800" onload="this.rel='stylesheet'" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <script>
    tailwind.config = { darkMode: "class", theme: { extend: {
      colors: { primary: "#1dc962", "background-light": "#f6f8f7", "background-dark": "#112117" },
      fontFamily: { display: ["Manrope"] },
    } } };
  </script>
  <title>{% trans "Log in" %}</title>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-slate-800 dark:text-slate-200">
  <div class="min-h-screen grid place-items-center p-6">
    <div class="w-full max-w-md bg-white dark:bg-slate-800/60 rounded-xl shadow-sm p-6">
      <div class="flex items-center justify-between mb-4">
        <div class="flex items-center gap-3">
          <svg class="h-8 w-8 text-primary" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M39.5563 34.1455V13.8546C39.5563 15.708 36.8773 17.3437 32.7927 18.3189C30.2914 18.916 27.263 19.2655 24 19.2655C20.737 19.2655 17.7086 18.916 15.2073 18.3189C11.1227 17.3437 8.44365 15.708 8.44365 13.8546V34.1455C8.44365 35.9988 11.1227 37.6346 15.2073 38.6098C17.7086 39.2069 20.737 39.5564 24 39.5564C27.263 39.5564 30.2914 39.2069 32.7927 38.6098C36.8773 37.6346 39.5563 35.9988 39.5563 34.1455Z"/></svg>
          <h1 class="text-xl font-bold">{% trans "Conecta Wellness" %}</h1>
        </div>
        {% include "professionals/includes/lang_switcher.html" %}
      </div>

      {% if form.errors or form.non_field_errors %}
        <div class="mb-4 text-sm text-red-700 bg-red-100 border border-red-200 rounded-lg p-3">
          {% trans "Invalid username or password." %}
        </div>
      {% endif %}

      {% if next and user.is_authenticated %}
        <div class="mb-4 text-sm text-amber-800 bg-amber-100 border border-amber-200 rounded-lg p-3">
          {% trans "Your account doesn't have access to this page." %}
        </div>
      {% endif %}

      <form method="post" action="{% url 'login' %}" class="space-y-4">
        {% csrf_token %}
        <div>
          <label for="{{ form.username.id_for_label }}" class="text-sm font-medium">{% trans "Email or username" %}</label>
          <input
            type="text" name="{{ form.username.html_name }}" id="{{ form.username.id_for_label }}"
            value="{{ form.username.value|default_if_none:'' }}" autofocus
            class="mt-1 w-full rounded-lg border border-primary/30 bg-background-light dark:bg-background-dark focus:ring-primary focus:border-primary" required
          />
        </div>

        <div>
          <label for="{{ form.password.id_for_label }}" class="text-sm font-medium">{% trans "Password" %}</label>
          <input
            type="password" name="{{ form.password.html_name }}" id="{{ form.password.id_for_label }}"
            class="mt-1 w-full rounded-lg border border-primary/30 bg-background-light dark:bg-background-dark focus:ring-primary focus:border-primary" required
          />
        </div>

        {% if next %}<input type="hidden" name="next" value="{{ next }}">{% endif %}

        <button type="submit" class="w-full h-11 rounded-lg bg-primary text-white font-bold hover:opacity-90 transition-opacity">
          {% trans "Log in" %}
        </button>
      </form>

      {% url 'password_reset' as pw_reset_url %}
      {% if pw_reset_url %}
        <div class="mt-4 text-center text-sm">
          <a href="{{ pw_reset_url }}" class="text-primary hover:underline">{% trans "Forgot your password?" %}</a>
        </div>
      {% endif %}
    </div>
  </div>
</body>
</html>
